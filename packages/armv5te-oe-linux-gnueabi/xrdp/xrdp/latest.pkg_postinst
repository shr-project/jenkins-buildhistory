\tif test -z "$D"\n\tthen\n\t\tif test -x /usr/bin/xrdp-keygen\n\t\tthen\n\t\t\t/usr/bin/xrdp-keygen xrdp /etc/xrdp/rsakeys.ini >/dev/null\n                fi\n\t\tif test ! -s /etc/xrdp/cert.pem\n\t\tthen\n\t\t\topenssl req -x509 -newkey rsa:2048 -sha256 -nodes -days 3652 \\\n\t\t\t-keyout /etc/xrdp/key.pem \\\n\t\t\t-out /etc/xrdp/cert.pem \\\n\t\t\t-config /etc/xrdp/openssl.conf >/dev/null 2>&1\n\t\t\tchmod 400 /etc/xrdp/key.pem\n\t\tfi\n        fi\nOPTS=""\n\nif [ -n "$D" ]; then\n    OPTS="--root=$D"\nfi\n\nif type systemctl >/dev/null 2>/dev/null; then\n\tif [ -z "$D" ]; then\n\t\tsystemctl daemon-reload\n\tfi\n\n\tsystemctl $OPTS enable xrdp.service xrdp-sesman.service\n\n\tif [ -z "$D" -a "enable" = "enable" ]; then\n\t\tsystemctl --no-block restart xrdp.service xrdp-sesman.service\n\tfi\nfi\nif [ x"$D" = "x" ]; then\n\tif [ -x /sbin/ldconfig ]; then /sbin/ldconfig ; fi\nfi\n