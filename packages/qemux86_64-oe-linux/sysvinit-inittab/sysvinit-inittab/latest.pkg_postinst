set -e\n# run this on host and on target\nif [ "${SERIAL_CONSOLES_CHECK}" = "" ]; then\n       exit 0\nfi\n\nif [ -n "$D" ]; then\n    $INTERCEPT_DIR/postinst_intercept delay_to_first_boot sysvinit-inittab mlprefix=\n    exit 0\nfi\n# run this on the target\nif [ -e /proc/consoles ]; then\n\ttmp="${SERIAL_CONSOLES_CHECK}"\n\tfor i in $tmp\n\tdo\n\t\tj=`echo ${i} | sed -e s/^.*\\;//g -e s/\\:.*//g`\n\t\tk=`echo ${i} | sed s/^.*\\://g`\n\t\tif [ -z "`grep ${j} /proc/consoles`" ]; then\n\t\t\tif [ -z "${k}" ] || [ -z "`grep ${k} /proc/consoles`" ] || [ ! -e /dev/${j} ]; then\n\t\t\t\tsed -i -e /^.*${j}\\ /d -e /^.*${j}$/d /etc/inittab\n\t\t\tfi\n\t\tfi\n\tdone\n\tkill -HUP 1\nelse\n\texit 1\nfi\n